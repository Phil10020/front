import{a3 as v,a4 as x,aN as w,y as m,q as B,ai as d,a7 as D,$ as n,a0 as N,a1 as s,c as a,ac as f,ak as i,b0 as I,a2 as t,a8 as p,af as P,aa as S,a9 as q,L as b,V as L}from"./index-9d038aab.js";import{V as R}from"./VContainer-7caee0b2.js";import{a as _,V as T}from"./VRow-624c6e5a.js";import{V as U}from"./VBreadcrumbs-9158148f.js";const $=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"名稱"),t("th",null,"詳情"),t("th",null,"刪除")])],-1),j={class:"d-flex align-center justify-center"},A={width:"15%"},E={class:"cart-view-description"},F={key:0},z=t("td",{colspan:"6",class:"text-center"},"沒有商品",-1),G=[z],W={__name:"CartView",setup(H){const u=v(),h=x(),y=w(),l=m([]),k=m([{title:"首頁",disabled:!1,to:"/"},{title:"行程管理",disabled:!1,to:""}]),C=async o=>{try{const{data:c}=await d.post("/users/cart",{productID:o,action:"delete"}),r=l.value.findIndex(e=>e.productID===o);r!==-1&&l.value.splice(r,1),h.cart=c.result}catch(c){u({text:c.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}},V=B(()=>l.value.length>0),g=async(o,c)=>{try{await d.post("/orders"),h.cart=0,y.push("/orders")}catch(r){console.log(r),u({text:r.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}};return(async()=>{try{const{data:o}=await d.get("/users/cart");l.value.push(...o.result)}catch(o){u({text:o.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}})(),(o,c)=>{const r=D("router-link");return n(),N(R,null,{default:s(()=>[a(T,null,{default:s(()=>[a(_,{cols:"12"},{default:s(()=>[a(U,{"bg-color":"transparant",items:k.value,class:"text-black position"},{title:s(({item:e})=>[f(i(e.title),1)]),_:1},8,["items"])]),_:1}),a(_,{cols:"12"},{default:s(()=>[a(I,null,{default:s(()=>[$,t("tbody",null,[(n(!0),p(S,null,P(l.value,e=>(n(),p("tr",{key:e._id},[a(r,{to:{name:"CityDetail",query:{id:e.productID,category:e.productCategory,city:e.productCity}}},{default:s(()=>[t("td",j,[t("div",null,[a(L,{src:e.Picture.PictureUrl1,cover:"",width:"200","aspect-ratio":"1"},null,8,["src"])])])]),_:2},1032,["to"]),t("td",A,i(e.productName),1),t("td",null,[t("p",E,i(e.Description||e.DescriptionDetail),1)]),t("td",null,[a(b,{color:"red",variant:"text",icon:"mdi-delete",onClick:J=>C(e.productID)},null,8,["onClick"])])]))),128)),l.value.length===0?(n(),p("tr",F,G)):q("",!0)])]),_:1})]),_:1}),a(_,{cols:"12",class:"text-center"},{default:s(()=>[a(b,{color:"secondary",onClick:g,disabled:!V.value},{default:s(()=>[f("儲存行程")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})}}};export{W as default};
