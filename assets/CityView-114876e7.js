import{p as ee,m as ae,aB as oe,a as te,O as ue,b as le,aC as re,aD as ce,E as ne,u as ie,W as de,aE as ve,c as t,U as fe,y as p,aF as ge,M as F,d as ye,aG as me,e as be,f as he,aH as pe,h as Ve,aI as _e,P as Pe,o as ke,n as xe,a6 as Le,s as we,r as j,Z as Ce,q as V,aJ as M,t as I,L as D,I as N,aK as G,aL as H,_ as Se,aM as Ie,aN as Ae,an as J,aO as Re,A as $e,a7 as Be,$ as R,a8 as Q,a2 as A,a1 as c,aa as X,aP as De,aQ as Z,aR as Ne,aS as qe,ac as T,ak as W,a0 as U,af as Fe,at as Me,V as Te,ax as Ue,a9 as ze,al as Ke,am as Ee}from"./index-b4d815b6.js";import{V as z}from"./VSheet-6ae55688.js";import{V as Oe}from"./VBreadcrumbs-e6d9ac2e.js";import{V as We}from"./VContainer-72d5f982.js";import{V as Y,a as q}from"./VRow-2660ce19.js";const je=ee({modelValue:Boolean,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},...ae(),...oe(),...te(),...ue({transition:"fade-transition"})},"VLazy"),Ge=le()({name:"VLazy",directives:{intersect:re},props:je(),emits:{"update:modelValue":e=>!0},setup(e,d){let{slots:u}=d;const{dimensionStyles:_}=ce(e),l=ne(e,"modelValue");function b(f){l.value||(l.value=f)}return ie(()=>de(t(e.tag,{class:["v-lazy",e.class],style:[_.value,e.style]},{default:()=>[l.value&&t(fe,{transition:e.transition,appear:!0},{default:()=>{var f;return[(f=u.default)==null?void 0:f.call(u)]}})]}),[[ve("intersect"),{handler:b,options:e.options},null]])),{}}});function He(){const e=p([]);ge(()=>e.value=[]);function d(u,_){e.value[_]=u}return{refs:e,updateRef:d}}const Je=ee({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:e=>e.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:e=>e%1===0},totalVisible:[Number,String],firstIcon:{type:F,default:"$first"},prevIcon:{type:F,default:"$prev"},nextIcon:{type:F,default:"$next"},lastIcon:{type:F,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...ye(),...ae(),...me(),...be(),...he(),...pe(),...te({tag:"nav"}),...Ve(),..._e({variant:"text"})},"VPagination"),Qe=le()({name:"VPagination",props:Je(),emits:{"update:modelValue":e=>!0,first:e=>!0,prev:e=>!0,next:e=>!0,last:e=>!0},setup(e,d){let{slots:u,emit:_}=d;const l=ne(e,"modelValue"),{t:b,n:f}=Pe(),{isRtl:g}=ke(),{themeClasses:L}=xe(e),{width:P}=Le(),h=we(-1);j(void 0,{scoped:!0});const{resizeRef:K}=Ce(a=>{if(!a.length)return;const{target:n,contentRect:o}=a[0],m=n.querySelector(".v-pagination__list > *");if(!m)return;const k=o.width,B=m.offsetWidth+parseFloat(getComputedStyle(m).marginRight)*2;h.value=w(k,B)}),r=V(()=>parseInt(e.length,10)),v=V(()=>parseInt(e.start,10)),y=V(()=>e.totalVisible?parseInt(e.totalVisible,10):h.value>=0?h.value:w(P.value,58));function w(a,n){const o=e.showFirstLastPage?5:3;return Math.max(0,Math.floor(+((a-n*o)/n).toFixed(2)))}const C=V(()=>{if(r.value<=0||isNaN(r.value)||r.value>Number.MAX_SAFE_INTEGER)return[];if(y.value<=1)return[l.value];if(r.value<=y.value)return M(r.value,v.value);const a=y.value%2===0,n=a?y.value/2:Math.floor(y.value/2),o=a?n:n+1,m=r.value-n;if(o-l.value>=0)return[...M(Math.max(1,y.value-1),v.value),e.ellipsis,r.value];if(l.value-m>=(a?1:0)){const k=y.value-1,B=r.value-k+v.value;return[v.value,e.ellipsis,...M(k,B)]}else{const k=Math.max(1,y.value-3),B=k===1?l.value:l.value-Math.ceil(k/2)+v.value;return[v.value,e.ellipsis,...M(k,B),e.ellipsis,r.value]}});function S(a,n,o){a.preventDefault(),l.value=n,o&&_(o,n)}const{refs:$,updateRef:E}=He();j({VPaginationBtn:{color:I(e,"color"),border:I(e,"border"),density:I(e,"density"),size:I(e,"size"),variant:I(e,"variant"),rounded:I(e,"rounded"),elevation:I(e,"elevation")}});const O=V(()=>C.value.map((a,n)=>{const o=m=>E(m,n);if(typeof a=="string")return{isActive:!1,key:`ellipsis-${n}`,page:a,props:{ref:o,ellipsis:!0,icon:!0,disabled:!0}};{const m=a===l.value;return{isActive:m,key:a,page:f(a),props:{ref:o,ellipsis:!1,icon:!0,disabled:!!e.disabled||+e.length<2,color:m?e.activeColor:e.color,ariaCurrent:m,ariaLabel:b(m?e.currentPageAriaLabel:e.pageAriaLabel,a),onClick:k=>S(k,a)}}}})),i=V(()=>{const a=!!e.disabled||l.value<=v.value,n=!!e.disabled||l.value>=v.value+r.value-1;return{first:e.showFirstLastPage?{icon:g.value?e.lastIcon:e.firstIcon,onClick:o=>S(o,v.value,"first"),disabled:a,ariaLabel:b(e.firstAriaLabel),ariaDisabled:a}:void 0,prev:{icon:g.value?e.nextIcon:e.prevIcon,onClick:o=>S(o,l.value-1,"prev"),disabled:a,ariaLabel:b(e.previousAriaLabel),ariaDisabled:a},next:{icon:g.value?e.prevIcon:e.nextIcon,onClick:o=>S(o,l.value+1,"next"),disabled:n,ariaLabel:b(e.nextAriaLabel),ariaDisabled:n},last:e.showFirstLastPage?{icon:g.value?e.firstIcon:e.lastIcon,onClick:o=>S(o,v.value+r.value-1,"last"),disabled:n,ariaLabel:b(e.lastAriaLabel),ariaDisabled:n}:void 0}});function s(){var n;const a=l.value-v.value;(n=$.value[a])==null||n.$el.focus()}function x(a){a.key===G.left&&!e.disabled&&l.value>+e.start?(l.value=l.value-1,H(s)):a.key===G.right&&!e.disabled&&l.value<v.value+r.value-1&&(l.value=l.value+1,H(s))}return ie(()=>t(e.tag,{ref:K,class:["v-pagination",L.value,e.class],style:e.style,role:"navigation","aria-label":b(e.ariaLabel),onKeydown:x,"data-test":"v-pagination-root"},{default:()=>[t("ul",{class:"v-pagination__list"},[e.showFirstLastPage&&t("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[u.first?u.first(i.value.first):t(D,N({_as:"VPaginationBtn"},i.value.first),null)]),t("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[u.prev?u.prev(i.value.prev):t(D,N({_as:"VPaginationBtn"},i.value.prev),null)]),O.value.map((a,n)=>t("li",{key:a.key,class:["v-pagination__item",{"v-pagination__item--is-active":a.isActive}],"data-test":"v-pagination-item"},[u.item?u.item(a):t(D,N({_as:"VPaginationBtn"},a.props),{default:()=>[a.page]})])),t("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[u.next?u.next(i.value.next):t(D,N({_as:"VPaginationBtn"},i.value.next),null)]),e.showFirstLastPage&&t("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[u.last?u.last(i.value.last):t(D,N({_as:"VPaginationBtn"},i.value.last),null)])])]})),{}}});const se=e=>(Ke("data-v-8a3c9bdd"),e=e(),Ee(),e),Xe={id:"cityView"},Ze={class:"city-contain mt-5"},Ye={class:"mb-5"},ea={class:"text-success"},aa=se(()=>A("h1",null,"沒有相關資料，",-1)),ta=se(()=>A("h1",{class:""},"請重新查詢。",-1)),la={__name:"CityView",setup(e){const d=Ie(),u=Ae();V(()=>d.query.city),V(()=>d.query.cityName);const _=J([]),l=p([{title:"首頁",disabled:!1,to:""},{title:"城市探索",disabled:!1,to:"city"},{title:"",disabled:!0,to:""}]);(async()=>{try{const i=await Re.get();console.log(i.data),await _.push(i.data)}catch{}})();const b=[{name:"景點",category:"ScenicSpot"},{name:"美食",category:"Restaurant"},{name:"旅宿",category:"Hotel"},{name:"活動",category:"Activity"}],f=p(d.query.city),g=p(b[0].category),L=p(d.query.city),P=p(g.value),h=J([]),K=V(()=>`${P.value}/${L.value}?%24top=1000&%24format=JSON`),r=p(""),v=p(""),y=async()=>{try{P.value=g.value,L.value=f.value,v.value=r.value;const s=(await De.get(K.value)).data.filter(x=>{const a=x.Picture&&x.Picture.PictureUrl1&&x.Picture.PictureUrl1.includes("https"),n=x[P.value+"Name"].includes(r.value);return a&&n});h.splice(0,h.length),h.push(...s),l.value[2].title=L.value||"",w.value=1,u.replace({query:{...d.query,city:L.value,category:P.value,keyword:v.value}})}catch(i){console.log(i)}},w=p(1),C=p(12),S=()=>window.innerWidth,$=p(7);$e(()=>{S()<768?(C.value=6,$.value=4):(C.value=12,$.value=7)});const E=V(()=>Math.ceil(h.length/C.value)),O=V(()=>{const i=(w.value-1)*C.value,s=i+C.value;return h.slice(i,s)});return P.value=d.query.category||"ScenicSpot",g.value=d.query.category||"ScenicSpot",L.value=d.query.city||"Taipei",f.value=d.query.city||"Taipei",r.value=d.query.keyword||"",v.value=d.query.keyword||"",y(),(i,s)=>{const x=Be("router-link");return R(),Q(X,null,[A("section",Xe,[t(z,{class:"banner"},{default:c(()=>[t(Y,{class:"justify-center search-bar",color:"transparent"},{default:c(()=>[t(q,{cols:"5",md:"2",class:""},{default:c(()=>[t(Z,{chips:"",label:"城市",items:_==null?void 0:_[0],variant:"solo",modelValue:f.value,"onUpdate:modelValue":s[0]||(s[0]=a=>f.value=a),"item-title":"CityName","item-value":"City"},null,8,["items","modelValue"])]),_:1}),t(q,{cols:"5",md:"2",class:""},{default:c(()=>[t(Z,{chips:"",label:"特色",items:b,variant:"solo",modelValue:g.value,"onUpdate:modelValue":[s[1]||(s[1]=a=>g.value=a),i.getData],"item-title":"name","item-value":"category"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(q,{cols:"10",md:"5",id:"search-icon"},{default:c(()=>[t(Ne,{"append-icon":"mdi-magnify",modelValue:r.value,"onUpdate:modelValue":s[2]||(s[2]=a=>r.value=a),label:"關鍵字搜尋","onClick:append":s[3]||(s[3]=a=>y()),onKeydown:s[4]||(s[4]=qe(a=>y(),["enter"])),variant:"solo-filled",class:"position-relative"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),A("section",Ze,[t(Oe,{"bg-color":"transparant",items:l.value,class:"text-black position"},{title:c(({item:a})=>[T(W(a.title),1)]),_:1},8,["items"]),t(We,null,{default:c(()=>[A("div",Ye,[A("h3",null,[T("搜尋到"),A("span",ea,W(h.length),1),T("筆資料")])]),h.length!==0?(R(),U(Y,{key:0},{default:c(()=>[(R(!0),Q(X,null,Fe(O.value,a=>(R(),U(q,{cols:"6",md:"3",key:a[P.value+"ID"]},{default:c(()=>[a[P.value+"Name"]!==void 0?(R(),U(x,{key:0,to:{name:"CityDetail",query:{id:a[g.value+"ID"],category:`${g.value}`,city:`${f.value}`}}},{default:c(()=>[t(Ge,{"min-height":200,options:{threshold:.5},transition:"fade-transition"},{default:c(()=>[t(Me,{class:"mx-auto","max-width":"400"},{default:c(()=>[t(Te,{class:"align-end text-secondary",height:"200",src:a==null?void 0:a.Picture.PictureUrl1,cover:""},{default:c(()=>[t(Ue,{style:{"background-color":"rgba(91, 112, 31,0.8)",color:"white"}},{default:c(()=>[T(W(a[P.value+"Name"]),1)]),_:2},1024)]),_:2},1032,["src"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["to"])):ze("",!0)]),_:2},1024))),128)),t(q,{cols:"10"},{default:c(()=>[t(Qe,{modelValue:w.value,"onUpdate:modelValue":s[5]||(s[5]=a=>w.value=a),length:E.value,"total-visible":$.value},null,8,["modelValue","length","total-visible"])]),_:1})]),_:1})):(R(),U(z,{key:1,height:"50vh"},{default:c(()=>[t(z,{class:"data-not-found d-flex align-center justify-center"},{default:c(()=>[t(z,{class:"d-flex text-secondary"},{default:c(()=>[aa,ta]),_:1})]),_:1})]),_:1}))]),_:1})])],64)}}},ra=Se(la,[["__scopeId","data-v-8a3c9bdd"]]);export{ra as default};
