import{a3 as w,aN as x,a4 as h,ao as k,$ as S,a0 as B,a1 as o,c as a,aA as C,ag as s,a_ as y,aR as c,a2 as p,L as F,ac as N}from"./index-b4d815b6.js";import{u as M,a as i,V as R}from"./vee-validate.esm-a60d8b48.js";import{c as U,a as m}from"./index.esm-dad49314.js";import{V as $}from"./VContainer-72d5f982.js";import{a as d,V as q}from"./VRow-2660ce19.js";const L=p("h1",null,"登入",-1),P={class:"text-center"},G={__name:"LoginView",setup(T){const n=w(),V=x(),f=h(),b=U({account:m().required("帳號必填").min(4,"帳號最少 4 個字").max(20,"帳號最多 20 個字"),password:m().required("密碼必填").min(4,"密碼最少 4 個字").max(20,"密碼最多 20 個字")}),{handleSubmit:g,isSubmitting:_}=M({validationSchema:b}),t=i("account"),r=i("password"),v=g(async l=>{try{const{data:e}=await k.post("/users/login",{account:l.account,password:l.password});f.login({token:e.result.token,account:e.result.account,email:e.result.email,cart:e.result.cart,role:e.result.role}),n({text:"登入成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),V.push("/")}catch(e){n({text:e.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(l,e)=>(S(),B($,null,{default:o(()=>[a(q,null,{default:o(()=>[a(d,{cols:"12"},{default:o(()=>[L]),_:1}),a(C),a(d,{cols:"12"},{default:o(()=>[a(R,{disabled:s(_),onSubmit:y(s(v),["prevent"])},{default:o(()=>[a(c,{modelValue:s(t).value.value,"onUpdate:modelValue":e[0]||(e[0]=u=>s(t).value.value=u),"error-messages":s(t).errorMessage.value,label:"帳號",counter:"",maxlength:"20"},null,8,["modelValue","error-messages"]),a(c,{modelValue:s(r).value.value,"onUpdate:modelValue":e[1]||(e[1]=u=>s(r).value.value=u),"error-messages":s(r).errorMessage.value,label:"密碼",counter:"",maxlength:"20",type:"password"},null,8,["modelValue","error-messages"]),p("div",P,[a(F,{type:"submit",color:"green"},{default:o(()=>[N("登入")]),_:1})])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}))}};export{G as default};
